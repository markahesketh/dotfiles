# Prefix key
unbind C-b
set -g prefix C-Space
bind C-Space send-prefix

# Splits
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind ! break-pane
bind @ command-prompt -p "Send to window:" "join-pane -t :'%%'"

# Mouse support
set -g mouse on

# Reduce scroll speed (default is 5 lines per tick)
bind -T copy-mode WheelUpPane send-keys -X -N 1 scroll-up
bind -T copy-mode WheelDownPane send-keys -X -N 1 scroll-down
bind -T copy-mode-vi WheelUpPane send-keys -X -N 1 scroll-up
bind -T copy-mode-vi WheelDownPane send-keys -X -N 1 scroll-down

# Switch panes with Alt+hjkl (no prefix)
bind -n M-h select-pane -L
bind -n M-j select-pane -D
bind -n M-k select-pane -U
bind -n M-l select-pane -R

# Switch panes by number with Alt+number (no prefix)
bind -n M-1 select-pane -t 1
bind -n M-2 select-pane -t 2
bind -n M-3 select-pane -t 3
bind -n M-4 select-pane -t 4

# Resize panes
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Reset any lingering styles
set -g window-style default
set -g window-active-style default

# Pane borders
set -g pane-border-lines single
set -g pane-border-status top
set -g pane-border-style default  # overridden per-mode below

# Windows
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on

# Scrollback
set -g history-limit 10000

# Terminal title (e.g. Ghostty tab name)
set -g set-titles on
set -g set-titles-string '#S'

# Status bar layout
set -g status-position bottom
set -g status-justify centre
set -g status-left-length 30
set -g status-right-length 50
setw -g window-status-separator '  '

# Colours: adapt to light/dark mode (reload config with prefix+r after switching)
if-shell "~/.config/tmux/is-dark-mode.sh" \
  "set -g status-style 'bg=default,fg=colour231'; \
   set -g status-left '  #[fg=colour241]#S   '; \
   set -g status-right '#[fg=colour241]  %H:%M %a %d %b  '; \
   setw -g window-status-format '#[bg=default,fg=colour241] ● #W '; \
   setw -g window-status-current-format '#[fg=colour231,bold] ● #W '; \
   setw -g window-status-current-style 'fg=colour231,bold'; \
   set -g message-style 'bg=default,fg=white'; \
   set -g mode-style 'bg=colour25,fg=white'; \
   set -g pane-border-style 'fg=colour238'; \
   set -g pane-active-border-style 'fg=colour238'; \
   set -g pane-border-format '#{?pane_active,#[fg=colour231 bold] ● #{pane_current_command} ,#[fg=colour241] ● #{pane_current_command} }'" \
  "set -g status-style 'bg=default,fg=colour237'; \
   set -g status-left '  #[fg=colour248]#S   '; \
   set -g status-right '#[fg=colour248]  %H:%M %a %d %b  '; \
   setw -g window-status-format '#[bg=default,fg=colour248] ● #W '; \
   setw -g window-status-current-format '#[fg=colour237,bold] ● #W '; \
   setw -g window-status-current-style 'fg=colour237,bold'; \
   set -g message-style 'bg=colour253,fg=colour237'; \
   set -g mode-style 'bg=colour253,fg=colour237'; \
   set -g pane-border-style 'fg=colour250'; \
   set -g pane-active-border-style 'fg=colour250'; \
   set -g pane-border-format '#{?pane_active,#[fg=colour237 bold] ● #{pane_current_command} ,#[fg=colour248] ● #{pane_current_command} }'"

# Reload config
bind r source-file ~/.tmux.conf \; display "Config reloaded"
